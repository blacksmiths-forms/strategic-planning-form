<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BlackSmiths LLC - ูููุฐุฌ ุงูุชุฎุทูุท ุงูุงุณุชุฑุงุชูุฌู</title>

  <style>
    body{font-family:Tajawal,Segoe UI,sans-serif;line-height:1.75;margin:40px;background:#f8f9fa}
    .header{background:linear-gradient(135deg,#FF6A00,#000000);color:#FFFFFF;padding:30px;text-align:center;border-radius:14px}
    .section{background:#FFFFFF;margin:20px 0;padding:25px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.08)}
    .partner-box{background:#FFF2E5;padding:15px;border-radius:10px;margin:15px 0;border-right:5px solid #FF6A00}
    .tip{background:#eef6ff;border:1px solid #cfe4ff;padding:12px;border-radius:10px;margin:12px 0}
    h2{color:#000;border-bottom:3px solid #FF6A00;padding-bottom:10px;margin:0 0 12px 0}
    h3{color:#000;margin:18px 0 6px 0}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:15px}
    label{display:block;font-weight:700;margin:8px 0 6px 0}
    textarea{
      width:100%;
      border:2px dashed #FF6A00;
      padding:12px;
      border-radius:10px;
      min-height:150px;
      background:#f8fafc;
      font-size:16px;
      resize:vertical;
      box-sizing:border-box;
    }
    textarea:focus{outline:none;border-color:#000000;background:#FFFFFF;box-shadow:0 0 0 3px rgba(255,106,0,0.18)}
    .example{color:#000;background:#FFF2E5;padding:12px;border-radius:8px;font-size:14px;margin:10px 0;border-left:4px solid #FF6A00}
    .example a{color:#000;text-decoration:underline}
    .toolbar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:center;margin:18px 0 0 0}
    .btn{background:#FF6A00;color:#FFFFFF;border:none;padding:12px 18px;font-size:16px;border-radius:10px;cursor:pointer}
    .btn.secondary{background:#000000}
    .btn.ghost{background:#FFFFFF;color:#000;border:1px solid #ddd}
    .btn:disabled{opacity:0.55;cursor:not-allowed}
    .status{margin:12px auto 0 auto;max-width:980px;text-align:center;font-size:14px;color:#333}
    .footer{text-align:center;padding:20px;background:#000000;border-radius:12px;margin:30px 0}
    .footer h3{color:#FFFFFF;margin:0}
    .no-print{display:block}
    @media print{
      body{margin:0;background:#fff}
      .no-print{display:none}
      .section{box-shadow:none}
      .header{border-radius:0}
      textarea{border:1px solid #ddd;background:#fff;box-shadow:none}
    }

    /* ===== Modal for sources (in-page) ===== */
    .modal-backdrop{
      position:fixed; inset:0;
      background:rgba(0,0,0,0.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      z-index:9999;
    }
    .modal{
      background:#fff;
      width:min(1100px, 96vw);
      height:min(80vh, 780px);
      border-radius:14px;
      overflow:hidden;
      box-shadow:0 12px 50px rgba(0,0,0,0.35);
      display:flex;
      flex-direction:column;
    }
    .modal-header{
      background:#000;
      color:#fff;
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .modal-header .title{
      font-weight:700;
      font-size:14px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .modal-header .actions{
      display:flex; gap:8px; align-items:center;
      flex-wrap:wrap;
    }
    .modal-header .smallbtn{
      background:#FF6A00;
      color:#fff;
      border:none;
      border-radius:10px;
      padding:8px 10px;
      cursor:pointer;
      font-size:13px;
      text-decoration:none;
      display:inline-block;
    }
    .modal-header .smallbtn.ghost{
      background:transparent;
      border:1px solid rgba(255,255,255,0.25);
    }
    .modal-body{
      flex:1;
      background:#f4f6f8;
      position:relative;
    }
    .modal-body iframe{
      width:100%;
      height:100%;
      border:0;
      background:#fff;
    }
    .modal-hint{
      position:absolute;
      inset:auto 12px 12px 12px;
      background:rgba(255,255,255,0.92);
      border:1px solid #e5e7eb;
      border-radius:12px;
      padding:10px 12px;
      font-size:13px;
      display:none;
    }

    @media (max-width: 1000px){ body{margin:22px} }
    @media (max-width: 700px){
      body{margin:14px}
      .section{padding:16px}
      .header{padding:20px}
      .grid{grid-template-columns:1fr}
      textarea{min-height:140px;font-size:16px}
      .toolbar{justify-content:stretch}
      .btn{width:100%}
      .modal{width:96vw;height:86vh}
    }
  </style>
</head>

<body>
  <div class="header">
    <h1 style="margin:0">๐ญ BlackSmiths LLC</h1>
    <h2 style="margin:10px 0 0 0;color:#FFFFFF;border-bottom:none">ูููุฐุฌ ุงูุชุฎุทูุท ุงูุงุณุชุฑุงุชูุฌู</h2>
  </div>

  <div class="partner-box no-print">
    <strong>ุชุนูููุงุช ุณุฑูุนุฉ:</strong>
    ุงูุชุจ ููุง ุชููุฑ โข ูุง ุชุญุงูู ุชูููุน ุงูุงุฌุงุจุฉ โข ูููุง ููุช ุตุฑูุญุง ูุงูุช ุงููุชุงุฆุฌ ุงูุถู
  </div>

  <div class="section no-print">
    <h2>ุงุฏูุงุช ุงููููุฐุฌ</h2>
    <div class="toolbar">
      <button class="btn" id="btnSave">ุญูุธ ุงูุขู</button>
      <button class="btn ghost" id="btnUndo">ุชุฑุงุฌุน ุนู ุขุฎุฑ ุชุนุฏูู</button>
      <button class="btn secondary" id="btnPrint">ุทุจุงุนุฉ / ุญูุธ PDF</button>
      <button class="btn ghost" id="btnClear">ูุณุญ ูู ุงูุจูุงูุงุช</button>
      <button class="btn secondary" id="btnSubmit">ุฅุฑุณุงู</button>
    </div>
    <div class="status" id="status">ุฌุงูุฒ.</div>
  </div>

  <div class="section">
    <h2>1. ุงูุฑุคูุฉ (Vision)</h2>
    <div class="tip">ุงูุชุจ ุฌููุฉ ูุงุญุฏุฉ ุชูุถูุญ ูุง ุงูุตูุฑุฉ ุงููุจูุฑุฉ ุงูุชู ุชุทูุญ ููุง.</div>

    <label for="vision">ุงูุชุจ ุงูุฑุคูุฉ</label>
    <textarea id="vision" placeholder="ุงูุชุจ ููุง..."></textarea>

    <div class="example">
      <strong>ุฃูุซูุฉ:</strong><br>
      โข ุณุงุจู (SABIC): "Our vision is to be the preferred world leader in chemicals." <a class="source-link" href="https://www.sabic.com/en/about/our-vision">ุงููุตุฏุฑ ุงูุฑุณูู</a><br>
      โข stc group: "digital and telco leader, enabling the society and economy to thrive, in KSA and beyond." <a class="source-link" href="https://www.stc.com/content/stcgroupwebsite/sa/en/content-page/who-we-are.html">ุงููุตุฏุฑ ุงูุฑุณูู</a><br>
      โข Colors Co. for Paints: โTo create a strong brand presence and be a market leader by continually striving for customer satisfaction and excellence in service.โ<br>
      โข Nexa Autocolor: โDelivering market-leading coating solutions through innovation, color expertise and digital technologies for the refinish industry.โ<br>
      โข PPG Paints: โTo be the first-choice partner for customers by delivering innovative and sustainable paint and coating solutions.โ<br>
      โข ุฃู ูุตุจุญ ุงูุฎูุงุฑ ุงูุฃูู ูู ูุทุงุนูุง ุฏุงุฎู ุงูุณูู ุงููุญูู ุฎูุงู ุงูุณููุงุช ุงููุงุฏูุฉ.<br>
      โข ุจูุงุก ุดุฑูุฉ ูุนุฑููุฉ ุจุฌูุฏุฉ ููุชุฌุงุชูุง ูุงุนุชูุงุฏ ุงูุนููุงุก ุนูููุง ุจุซูุฉ.
    </div>
  </div>

  <div class="section">
    <h2>2. ุงูุฑุณุงูุฉ (Mission)</h2>

    <div class="tip">
      ุงูุชุจ 1โ2 ุฌููุฉ ุชูุถูุญ:<br>
      โข ูุงุฐุง ููุฏูุ<br>
      โข ูููุ<br>
      โข ูููู ูุญูู ูููุฉ ุญููููุฉุ<br>
      ุงูุฑุณุงูุฉ ุชุตู ูุง ูููู ุจู ุงููููุ ูููุณ ูุง ูุชููู ุงููุตูู ุฅููู ูุณุชูุจูุงู.
    </div>

    <label for="mission">ุงูุชุจ ุงูุฑุณุงูุฉ</label>
    <textarea id="mission" placeholder="ุงูุชุจ ููุง..."></textarea>

    <div class="example">
      <strong>ุฃูุซูุฉ:</strong><br>
      โข ุณุงุจู (SABIC): "โฆprovide quality products and servicesโฆ" (โฆุชูุฏูู ููุชุฌุงุช ูุฎุฏูุงุช ุนุงููุฉ ุงูุฌูุฏุฉโฆ) <a class="source-link" href="https://www.sabic.com/en/about/our-vision">ุงููุตุฏุฑ ุงูุฑุณูู</a><br>
      โข Colors Co. for Paints: โDeliver total customer satisfaction through high-quality products, reliable logistics, and professional after-sales support.โ<br>
      โข Nexa Autocolor: โProviding high-performance automotive refinish coatings, advanced color tools and technical support to enable customer success.โ<br>
      โข PPG Paints: โWe protect and beautify the world by developing and delivering paints and coatings that our customers trust.โ<br>
      โข ุชูุฏูู ููุชุฌุงุช ููุซููุฉ ูุฎุฏูุงุช ุฏุงุนูุฉ ุชุณุงุนุฏ ุนููุงุกูุง ุนูู ุชุญููู ูุชุงุฆุฌ ุฃูุถู ูู ุฃุนูุงููู.<br>
      โข ุชูููู ุนููุงุฆูุง ูู ุฎูุงู ุญููู ุนูููุฉุ ูุฏุนู ููู ูุณุชูุฑุ ูุนูุงูุงุช ุทูููุฉ ุงูุฃูุฏ.
    </div>
  </div>

  <div class="section">
    <h2>3. ุงูููู (Values)</h2>

    <div class="tip">
      ุงูุชุจ ูู 4 ุฅูู 6 ููู ุชุนุจูุฑ ุนู ุทุฑููุฉ ุนูููุง ูุงุชุฎุงุฐูุง ูููุฑุงุฑุงุช.<br>
      ููู ูููุฉุ ุญุงูู ุฑุจุทูุง ุจุณููู ุนููู ูุธูุฑ ูู ุงูุนูู ุงููููู.
    </div>

    <label for="values">ุงูููู + ุฃูุซูุฉ ุณููููุฉ</label>
    <textarea id="values" placeholder="ุงูุชุจ ููุง..."></textarea>

    <div class="example">
      <strong>ุฃูุซูุฉ:</strong><br>
      โข ุณุงุจู (SABIC): "โฆINSPIRE, ENGAGE, CREATE and DELIVER." (โฆูููููุ ูุดุงุฑูุ ูุจุฏุนุ ููููุฌุฒโฆ) <a class="source-link" href="https://www.sabic.com/en/about/our-vision">ุงููุตุฏุฑ ุงูุฑุณูู</a><br>
      โข GSK: "Patient focusโฆ Integrityโฆ Respectโฆ Transparency." (ุงูุชุฑููุฒ ุนูู ุงููุฑูุถโฆ ุงููุฒุงูุฉโฆ ุงูุงุญุชุฑุงูโฆ ุงูุดูุงููุฉ.) <a class="source-link" href="https://india-pharma.gsk.com/media/ig1bxrzh/code-of-conduct-policy-english.pdf">ุงููุตุฏุฑ ุงูุฑุณูู</a><br>
      โข Colors Co. for Paints: ุงูุฌูุฏุฉ (Quality) โข ุงูุซูุฉ (Trust) โข ุงูุชููุฒ (Excellence) โข ุงูุนูู ุงูุฌูุงุนู (Teamwork) โข ุงููุฒุงูุฉ (Integrity)<br>
      โข PPG Paints: ุงูุงุจุชูุงุฑ (Innovation) โข ุงูุงุณุชุฏุงูุฉ (Sustainability) โข ุงูุชุฑููุฒ ุนูู ุงูุนููู (Customer focus) โข ุงูุณูุงูุฉ (Safety) โข ุงููุฒุงูุฉ (Integrity)<br>
      โข SATA: ุงูุฏูุฉ (Precision) โข ุงูุฌูุฏุฉ (Quality) โข ุงูุงุจุชูุงุฑ (Innovation) โข ุงููุณุคูููุฉ (Responsibility) โข ุงูุดุบู ุจุงูุชูููุฉ (Passion for technology)
    </div>
  </div>

  <div class="section">
    <h2>4. ูู ูุญู (Who We Are)</h2>

    <div class="tip">
      ุงูุชุจ ูู 3 ุฅูู 6 ุฌูู ุชุนุฑูู ุจุงูุดุฑูุฉ ููุง ูู ุงููููุ ูุชุดูู:<br>
      โข ุทุจูุนุฉ ุงููุดุงุท<br>
      โข ููุน ุงูุนููุงุก<br>
      โข ูุง ุงูุฐู ูููุฒูุง ุนู ุบูุฑูุง<br>
      โข ูุทุงู ุนูููุง (ูุญูู / ุฅููููู)
    </div>

    <label for="who">ุงูุชุจ ุชุนุฑูู ุงูุดุฑูุฉ</label>
    <textarea id="who" placeholder="ุงูุชุจ ููุง..."></textarea>

    <div class="example">
      <strong>ุฃูุซูุฉ:</strong><br>
      โข ุณุงุจู (SABIC): "SABIC is a global diversified chemicals company, headquartered in Riyadh, Saudi Arabia." <a class="source-link" href="https://www.sabic.com/en/about/corporate-profile/sabic-at-a-glance">ุงููุตุฏุฑ ุงูุฑุณูู</a><br>
      โข Colors Co. for Paints: โColors Co. for Paints is a Saudi company established in 1989, specializing in automotive refinish paints and body shop solutions, serving customers across the Kingdom.โ<br>
      โข Nexa Autocolor: โNexa Autocolor is a global automotive refinish brand delivering high-performance coatings, digital color tools, and technical expertise to professional body shops worldwide.โ<br>
      โข PPG Paints: โPPG is a global leader in paints, coatings, and specialty materials, combining innovation and sustainability to support customers in diverse industries.โ<br>
      โข SATA: โSATA GmbH & Co. KG is a global leader in wet paint application technologies, known for precision spray guns and high-quality finishing systems.โ<br>
      โข ูุญู ุดุฑูุฉ ุชุนูู ูู ูุฌุงู ุชูุฒูุน ูุชุทููุฑ ุงูููุชุฌุงุช ุงููุชุฎุตุตุฉุ ูุฎุฏู ุดุฑูุญุฉ ูุญุฏุฏุฉ ูู ุงูุนููุงุก ูู ุฎูุงู ุญููู ุนูููุฉ ูุฏุนู ููู ูุจุงุดุฑ.<br>
      โข ูุฑูุฒ ุนูู ุจูุงุก ุนูุงูุงุช ุทูููุฉ ุงููุฏู ูุน ุนููุงุฆูุงุ ููุนุชูุฏ ุนูู ุฎุจุฑุฉ ุงููุฑูู ูููู ุงูุณูู ุงููุญูู.
    </div>
  </div>

    <div class="section">
    <h2>5. ุฎุทุฉ ุงูุณูุชูู 2026โ2027 (Balanced Scorecard)</h2>
    <div class="tip">ุงูุชุจ ููู ุชุฑูุฏ ุฃู ูุจุฏู ูุถุน ุงูุดุฑูุฉ ุจููุงูุฉ ูู ุณูุฉุ ูุน ุงูุชุฑููุฒ ุนูู ุงููุฑุงุฑุงุช ูุงููุชุงุฆุฌ. ุญุงูููุง ุชููููุง ุฏููููู ูู ุงูุฃุฌูุจุฉ.</div>

    <h3>ุฃ) ุงูุณูุฉ ุงูุฃููู (ุงูุชุฃุณูุณ ูุงูุซุจุงุช) 2026: ุจููุงูุฉ ุงูุนุงูุ ูุง ุงูุฐู ูุฌุจ ุฃู ูููู ูุฏ ุงุณุชูุฑ ุญุชู ูุณุชุทูุน ุงูุชูุณุน ุจุซูุฉุ</h3>

    <div class="grid">
      <div>
        <h3 style="margin-top:0">ุงููุงููุฉ (Financial)</h3>
        <div class="tip">
          โข ูุง ุงูุฐู ูุฌุจ ุฃู ูุชุญุณู ุฃู ูุณุชูุฑ ูุงูููุงุ<br>
          โข ูุง ุงูุฃูุดุทุฉ ุฃู ุงูุชูุงููู ุงูุชู ูุฌุจ ุชูููููุง ุฃู ุฅููุงููุงุ
        </div>
        <textarea id="y2026_fin" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุชุญุณูู ุงูุงุณุชูุฑุงุฑ ุงูููุฏู.<br>
          โข ุชูููู ุงูุงุนุชูุงุฏ ุนูู ูุตุฏุฑ ุฏุฎู ูุงุญุฏ.<br>
          โข ุถุจุท ุงูุชูุงููู ุงูุชุดุบูููุฉ ุงูุฃุณุงุณูุฉ.
        </div>
      </div>

      <div>
        <h3 style="margin-top:0">ุงูุนููุงุก ูุงูุณูู (Customers)</h3>
        <div class="tip">
          โข ูู ูู ุงูุนููู ุงูุฐู ูุฑูุฒ ุนููู ูุนูููุงุ<br>
          โข ูุง ุงููููุฉ ุงูุฃุณุงุณูุฉ ุงูุชู ููุฏููุง ููุ
        </div>
        <textarea id="y2026_cust" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุงูุชุฑููุฒ ุนูู ุดุฑูุญุฉ ุนููุงุก ูุญุฏุฏุฉ ุจุฏู ุงูุชุดุชุช.<br>
          โข ุชุญุณูู ุชุฌุฑุจุฉ ูุง ุจุนุฏ ุงูุจูุน.<br>
          โข ุฒูุงุฏุฉ ุชูุฑุงุฑ ุงูุดุฑุงุก ูู ุงูุนููุงุก ุงูุญุงูููู.
        </div>
      </div>

      <div>
        <h3 style="margin-top:0">ุงูุนูููุงุช ุงูุฏุงุฎููุฉ (Internal Operations)</h3>
        <div class="tip">
          โข ูุง ุงูุนูููุฉ ุงูุชู ูุฌุจ ุฃู ุชุตุจุญ ูุงุถุญุฉ ููุณุชูุฑุฉุ<br>
          โข ุฃูู ุงูููุถู ุงูุชู ูุฌุจ ูุนุงูุฌุชูุง ุฃูููุงุ
        </div>
        <textarea id="y2026_ops" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุชูุญูุฏ ุขููุฉ ุงูุทูุจ ูุงูุชุณููู.<br>
          โข ุชูููู ุงูุฃุฎุทุงุก ุงูุชุดุบูููุฉ.<br>
          โข ุชูุซูู ุงูุนูููุงุช ุงูุฃุณุงุณูุฉ.
        </div>
      </div>

      <div>
        <h3 style="margin-top:0">ุงููุฑูู ูุงูุชุนูู (People &amp; Learning)</h3>
        <div class="tip">
          โข ูุง ุงูุฃุฏูุงุฑ ุงูุญุฑุฌุฉ ุงูุชู ูุฌุจ ุชุซุจูุชูุงุ<br>
          โข ูุง ุงูุณููู ุฃู ุงูุซูุงูุฉ ุงูุชู ูุญุชุงุฌ ุชุฑุณูุฎูุงุ
        </div>
        <textarea id="y2026_people" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุชุซุจูุช ุฃุฏูุงุฑ ุฃุณุงุณูุฉ ูู ุงููุจูุนุงุช ูุงูุนูููุงุช.<br>
          โข ุชุญุณูู ุงูุชูุงุตู ุงูุฏุงุฎูู.<br>
          โข ุฑูุน ูุณุชูู ุงููุณุงุกูุฉ ูุงููุถูุญ.
        </div>
      </div>
    </div>

    <h3 style="margin-top:22px">ุจ) ุงูุณูุฉ ุงูุซุงููุฉ (ุงูุชุญุณูู ูุงูุชูุณุน) 2027: ูุง ุงูุฐู ูุฌุจ ุฃู ูุถุงุนูู ุฃู ูุชูุณุน ูููุ</h3>

    <div class="grid">
      <div>
        <h3 style="margin-top:0">ุงููุงููุฉ (Financial)</h3>
        <div class="tip">
          โข ุฃูู ูุฒูุฏุ<br>
          โข ููู ูุญุณูู ุงูููุงุกุฉ ุงููุงููุฉุ
        </div>
        <textarea id="y2027_fin" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุฒูุงุฏุฉ ุงูุฅูุฑุงุฏุงุช ูู ุงูููุชุฌุงุช ุฃู ุงูุฎุฏูุงุช ุงููุงุฌุญุฉ.<br>
          โข ุชุญุณูู ููุงูุด ุงูุฑุจุญ.<br>
          โข ุชูููุน ูุตุงุฏุฑ ุงูุฏุฎู.<br>
          โข Gross Profit Margin (Target โฅ 20%)<br>
          โข % Revenue from Top 3 Products (Target โฅ 65%)
        </div>
      </div>

      <div>
        <h3 style="margin-top:0">ุงูุนููุงุก ูุงูุณูู (Customers)</h3>
        <div class="tip">
          โข ูู ููุณุน ููุณ ุงูุดุฑูุญุฉ ุฃู ูุถูู ุดุฑูุญุฉ ุฌุฏูุฏุฉุ<br>
          โข ููู ูุฑูุน ุงูููุงุก ุฃู ุงูุชูุฑุงุฑุ
        </div>
        <textarea id="y2027_cust" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุงูุชูุณุน ูู ููุงุทู ุฌุฏูุฏุฉ.<br>
          โข ุจูุงุก ุดุฑุงูุงุช ุงุณุชุฑุงุชูุฌูุฉ.<br>
          โข ุชุนุฒูุฒ ุณูุนุฉ ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ.
        </div>
      </div>

      <div>
        <h3 style="margin-top:0">ุงูุนูููุงุช ุงูุฏุงุฎููุฉ (Internal Operations)</h3>
        <div class="tip">
          โข ูุง ุงูุฐู ูููู ุฃุชูุชุชู ุฃู ุชุญุณูููุ<br>
          โข ูุง ุงูุฐู ูุฌุจ ุฅูุบุงุคู ุฃู ุชุจุณูุทูุ
        </div>
        <textarea id="y2027_ops" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุงุณุชุฎุฏุงู ุฃูุธูุฉ ุฃูุถู ูููุชุงุจุนุฉ.<br>
          โข ุชูููู ุงูุงุนุชูุงุฏ ุนูู ุงูุนูู ุงููุฏูู.<br>
          โข ุชุณุฑูุน ุฏูุฑุฉ ุงูุนูู.<br>
          โข % Automated Operations (Target โฅ 70%)
        </div>
      </div>

      <div>
        <h3 style="margin-top:0">ุงููุฑูู ูุงูุชุนูู (People &amp; Learning)</h3>
        <div class="tip">
          โข ููู ูููู ุงูุงุนุชูุงุฏ ุนูู ุฃูุฑุงุฏ ูุญุฏุฏููุ<br>
          โข ูุง ุงูููุงุฑุงุช ุงูุชู ูุฌุจ ุชุทููุฑูุงุ
        </div>
        <textarea id="y2027_people" placeholder="ุงูุชุจ ููุง..."></textarea>
        <div class="example">
          <strong>ุฃูุซูุฉ:</strong><br>
          โข ุชุฏุฑูุจ ูุงุฏุฉ ุงูุตู ุงูุซุงูู.<br>
          โข ููู ุงููุนุฑูุฉ ุฏุงุฎู ุงููุฑูู.<br>
          โข ุจูุงุก ุซูุงูุฉ ุชุนูู ูุณุชูุฑุฉ.<br>
          โข Revenue per Employee (benchmark: โฅ X per year)<br>
          โข % Of Workforce in Sales vs Operations
        </div>
      </div>
    </div>
  </div>

<div class="section">
    <h2>6. ุงูููุงุญุธุงุช</h2>
    <div class="tip">ุงูุชุจ ุฃู ุฃููุงุฑุ ููุงุญุธุงุชุ ูุฎุงููุ ุฃู ูุฑุต ุชุฑู ุฃููุง ูููุฉ ููู ุชุฌุฏ ููุงูุงู ููุงุณุจุงู ููุง ูู ุงูุจููุฏ ุงูุณุงุจูุฉ.</div>
    <label for="notes">ุงูููุงุญุธุงุช</label>
    <textarea id="notes" placeholder="ุงูุชุจ ููุง..."></textarea>
  </div>

  <div class="footer">
    <h3>ุณูุชู ุฌูุน ุฌููุน ุงููุณุฎ ูู ุงุฌุชูุงุน ูุดุชุฑู ูุตูุงุบุฉ ุงููุณุฎุฉ ุงูููุงุฆูุฉ</h3>
  </div>

  <div style="text-align:center;margin:30px 0" class="no-print">
    <button class="btn secondary" id="btnSubmitBottom">ุฅุฑุณุงู</button>
  </div>

  <!-- Redirect submit form (NO target, NO iframe, NO popup) -->
  <form id="submitForm" class="no-print"
        action="https://script.google.com/macros/s/AKfycbwVr3kCNhoWAcslUQlM5aEYVwU5NM8o1kNegA9y2lb2wf-Sl8Gj2ZOj6qvBpAAy0VI/exec"
        method="POST"
        style="position:fixed;left:0;top:0;width:1px;height:1px;opacity:0;pointer-events:none;overflow:hidden;">
    <input type="hidden" name="payload" id="payloadField" value="">
  </form>

  <!-- ===== Modal (in-page sources) ===== -->
  <div class="modal-backdrop no-print" id="sourceModalBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="ุงููุตุฏุฑ ุงูุฑุณูู">
      <div class="modal-header">
        <div class="title" id="sourceModalTitle">ุงููุตุฏุฑ ุงูุฑุณูู</div>
        <div class="actions">
          <a class="smallbtn ghost" id="sourceModalOpenNew" href="#" target="_blank" rel="noopener">ูุชุญ ูู ุชุจููุจ ุฌุฏูุฏ</a>
          <button class="smallbtn" id="sourceModalClose" type="button">ุฅุบูุงู</button>
        </div>
      </div>
      <div class="modal-body">
        <iframe id="sourceModalFrame" title="ุงููุตุฏุฑ ุงูุฑุณูู"></iframe>
        <div class="modal-hint" id="sourceModalHint">
          ูุฏ ูููุน ุงููููุน ุงูุนุฑุถ ุฏุงุฎู ูุฐู ุงููุงูุฐุฉ. ุงุณุชุฎุฏู ุฒุฑ "ูุชุญ ูู ุชุจููุจ ุฌุฏูุฏ".
        </div>
      </div>
    </div>
  </div>

  <script>
    const SHEET_ID_USED = "1kTuTJboa_M9pAcAudFY2UGtYWYurRV2w3pps5VjoQqE";
    const STORAGE_KEY = "blacksmiths_strategic_form_v20_content_only";

    const FIELD_IDS = [
      "vision","mission","values","who",
      "y2026_fin","y2026_cust","y2026_ops","y2026_people",
      "y2027_fin","y2027_cust","y2027_ops","y2027_people",
      "notes"
    ];

    const statusEl = document.getElementById("status");
    function nowTime(){ return new Date().toLocaleString("ar-SA"); }
    function setStatus(msg){ if(statusEl) statusEl.textContent = msg; }

    function getAllData(){
      const data = { _meta: { savedAt: nowTime(), version: 20, sheetId: SHEET_ID_USED } };
      for (const id of FIELD_IDS){
        const el = document.getElementById(id);
        data[id] = el ? el.value : "";
      }
      return data;
    }

    function setAllData(data){
      for (const id of FIELD_IDS){
        const el = document.getElementById(id);
        if (el) el.value = (data && typeof data[id] === "string") ? data[id] : "";
      }
    }

    function saveToLocal(){
      const data = getAllData();
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      setStatus("ุชู ุงูุญูุธ ูุญููุง: " + data._meta.savedAt);
    }

    function loadFromLocal(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw){ setStatus("ูุง ููุฌุฏ ุจูุงูุงุช ูุญููุธุฉ ูุญููุง ุจุนุฏ."); return; }
      try{
        const data = JSON.parse(raw);
        setAllData(data);
        setStatus("ุชู ุชุญููู ุจูุงูุงุช ูุญููุธุฉ: " + (data?._meta?.savedAt || nowTime()));
      }catch(e){
        setStatus("ุชุนุฐุฑ ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงููุญููุธุฉ (ูุฏ ุชููู ุชุงููุฉ).");
      }
    }

    function clearAll(){
      for (const id of FIELD_IDS){
        const el = document.getElementById(id);
        if (el) el.value = "";
      }
      localStorage.removeItem(STORAGE_KEY);
      setStatus("ุชู ูุณุญ ุงูุจูุงูุงุช.");
    }

    let saveTimer = null;
    function scheduleAutosave(){
      if (saveTimer) clearTimeout(saveTimer);
      saveTimer = setTimeout(() => saveToLocal(), 600);
    }

    let lastUndo = null;
    function captureUndoState(el){
      if (!el || !el.id) return;
      lastUndo = {
        id: el.id,
        value: el.value,
        selStart: (typeof el.selectionStart === "number") ? el.selectionStart : null,
        selEnd: (typeof el.selectionEnd === "number") ? el.selectionEnd : null
      };
      const btnUndo = document.getElementById("btnUndo");
      if (btnUndo) btnUndo.disabled = false;
    }

    function doUndo(){
      if (!lastUndo) { setStatus("ูุง ููุฌุฏ ุชุนุฏูู ููุชุฑุงุฌุน ุนูู."); return; }
      const el = document.getElementById(lastUndo.id);
      if (!el) { setStatus("ุชุนุฐุฑ ุงูุชุฑุงุฌุน (ุงูุญูู ุบูุฑ ููุฌูุฏ)."); return; }
      el.value = lastUndo.value;
      el.focus();
      try{
        if (lastUndo.selStart !== null && lastUndo.selEnd !== null){
          el.setSelectionRange(lastUndo.selStart, lastUndo.selEnd);
        }
      }catch(_){}
      lastUndo = null;
      const btnUndo = document.getElementById("btnUndo");
      if (btnUndo) btnUndo.disabled = true;
      scheduleAutosave();
      setStatus("ุชู ุงูุชุฑุงุฌุน ุนู ุขุฎุฑ ุชุนุฏูู.");
    }

    let isSubmitting = false;
    function setSubmittingUI(on){
      const btnSubmit = document.getElementById("btnSubmit");
      const btnSubmitBottom = document.getElementById("btnSubmitBottom");
      if (btnSubmit) btnSubmit.disabled = on;
      if (btnSubmitBottom) btnSubmitBottom.disabled = on;
      if (btnSubmit) btnSubmit.textContent = on ? "ุฌุงุฑู ุงูุฅุฑุณุงู..." : "ุฅุฑุณุงู";
      if (btnSubmitBottom) btnSubmitBottom.textContent = on ? "ุฌุงุฑู ุงูุฅุฑุณุงู..." : "ุฅุฑุณุงู";
    }

    function submitToServer(){
      if (isSubmitting) return;
      isSubmitting = true;
      setSubmittingUI(true);
      setStatus("ุฌุงุฑู ุงูุฅุฑุณุงู...");

      const data = getAllData();
      document.getElementById("payloadField").value = JSON.stringify(data);

      document.getElementById("submitForm").submit();
    }

    // Modal sources
    const backdrop = document.getElementById("sourceModalBackdrop");
    const frame2 = document.getElementById("sourceModalFrame");
    const titleEl = document.getElementById("sourceModalTitle");
    const hintEl = document.getElementById("sourceModalHint");
    const openNewEl = document.getElementById("sourceModalOpenNew");
    const closeBtn = document.getElementById("sourceModalClose");

    function openSourceModal(url){
      hintEl.style.display = "none";
      frame2.src = "about:blank";
      titleEl.textContent = "ุงููุตุฏุฑ ุงูุฑุณูู";
      openNewEl.href = url;
      backdrop.style.display = "flex";
      backdrop.setAttribute("aria-hidden", "false");
      frame2.src = url;
      setTimeout(() => { hintEl.style.display = "block"; }, 2500);
    }

    function closeSourceModal(){
      frame2.src = "about:blank";
      backdrop.style.display = "none";
      backdrop.setAttribute("aria-hidden", "true");
    }

    backdrop.addEventListener("click", (e) => { if (e.target === backdrop) closeSourceModal(); });
    closeBtn.addEventListener("click", closeSourceModal);
    document.addEventListener("keydown", (e) => { if (e.key === "Escape" && backdrop.style.display === "flex") closeSourceModal(); });

    window.addEventListener("DOMContentLoaded", () => {
      loadFromLocal();

      const btnUndo = document.getElementById("btnUndo");
      if (btnUndo) btnUndo.disabled = true;

      for (const id of FIELD_IDS){
        const el = document.getElementById(id);
        if (!el) continue;
        el.addEventListener("beforeinput", () => captureUndoState(el));
        el.addEventListener("focus", () => captureUndoState(el));
        el.addEventListener("input", scheduleAutosave);
      }

      const btnSave = document.getElementById("btnSave");
      if (btnSave) btnSave.addEventListener("click", saveToLocal);

      if (btnUndo) btnUndo.addEventListener("click", doUndo);

      const btnSubmit = document.getElementById("btnSubmit");
      if (btnSubmit) btnSubmit.addEventListener("click", submitToServer);

      const btnSubmitBottom = document.getElementById("btnSubmitBottom");
      if (btnSubmitBottom) btnSubmitBottom.addEventListener("click", submitToServer);

      const btnPrint = document.getElementById("btnPrint");
      if (btnPrint) btnPrint.addEventListener("click", () => window.print());

      const btnClear = document.getElementById("btnClear");
      if (btnClear) btnClear.addEventListener("click", () => {
        const ok = confirm("ูู ุงูุช ูุชุฃูุฏุ ุณูุชู ูุณุญ ูู ุงูุจูุงูุงุช ูู ูุฐุง ุงูุฌูุงุฒ.");
        if (ok) clearAll();
      });

      document.querySelectorAll("a.source-link").forEach(a => {
        a.setAttribute("rel", "noopener");
        a.addEventListener("click", (e) => {
          e.preventDefault();
          const url = a.getAttribute("href");
          if (url) openSourceModal(url);
        });
      });
    });
  </script>
</body>
</html>
